(function(a,o,n,i){var t=function(i,t){this.elem=i;this.$elem=a(i);this.options=t;this.metadata=this.$elem.data("plugin-options");this.$win=a(o);this.sections={};this.didScroll=false;this.$doc=a(n);this.docHeight=this.$doc.height()};t.prototype={defaults:{navItems:"a",currentClass:"current",changeHash:false,easing:"swing",filter:"",scrollSpeed:750,scrollThreshold:.5,begin:false,end:false,scrollChange:false},init:function(){this.config=a.extend({},this.defaults,this.options,this.metadata);this.$nav=this.$elem.find(this.config.navItems);if(this.config.filter!==""){this.$nav=this.$nav.filter(this.config.filter)}this.$nav.on("click.onePageNav touchend",a.proxy(this.handleClick,this));this.getPositions();this.bindInterval();this.$win.on("resize.onePageNav",a.proxy(this.getPositions,this));return this},adjustNav:function(i,t){i.$elem.find("."+i.config.currentClass).removeClass(i.config.currentClass);t.addClass(i.config.currentClass)},bindInterval:function(){var i=this;var t;i.$win.on("scroll.onePageNav",function(){i.didScroll=true});i.t=setInterval(function(){t=i.$doc.height();if(i.didScroll){i.didScroll=false;i.scrollChange()}if(t!==i.docHeight){i.docHeight=t;i.getPositions()}},250)},getHash:function(i){return i.attr("href").split("#")[1]},getPositions:function(){var i=this;var t;var n;var e;i.$nav.each(function(){t=i.getHash(a(this));e=a("#"+t);if(e.length){n=e.offset().top;i.sections[t]=Math.round(n)}})},getSection:function(i){var t=null;var n=Math.round(this.$win.height()*this.config.scrollThreshold);for(var e in this.sections){if(this.sections[e]-n-this.headerOffsetTop()<=i){t=e}}return t},headerOffsetTop:function(){var i=0;if(a("#wpadminbar").length>0&&a("#wpadminbar").css("position")=="fixed"){i=a("#wpadminbar").outerHeight()}if(a("header.main-header .header-sticky").length>0){if(a("header.main-header .header-sticky").css("position")=="fixed"){i+=a("header.main-header .header-sticky").outerHeight()}else{i+=80}}return i},handleClick:function(i){var t=this;var n=a(i.currentTarget);var e=n.parent();var s="#"+t.getHash(n);if(s=="#undefined"){return}if(!e.hasClass(t.config.currentClass)){if(t.config.begin){t.config.begin()}t.adjustNav(t,e);t.unbindInterval();t.scrollTo(s,function(){if(t.config.changeHash){o.location.hash=s}t.bindInterval();if(t.config.end){t.config.end()}})}i.preventDefault()},scrollChange:function(){var i=this.$win.scrollTop();var t=this.getSection(i);var n;if(t!==null){n=this.$elem.find('a[href$="#'+t+'"]').parent();if(!n.hasClass(this.config.currentClass)){this.adjustNav(this,n);if(this.config.scrollChange){this.config.scrollChange(n)}}}},scrollTo:function(i,t){if(a(i).length==0){return}var n=a(i).offset().top-this.headerOffsetTop();a("html, body").animate({scrollTop:n},this.config.scrollSpeed,this.config.easing,t)},unbindInterval:function(){clearInterval(this.t);this.$win.unbind("scroll.onePageNav")}};t.defaults=t.prototype.defaults;a.fn.onePageNav=function(i){return this.each(function(){new t(this,i).init()})}})(jQuery,window,document);